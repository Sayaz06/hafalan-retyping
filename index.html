<!doctype html>
<html lang="ms">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>hafalan retyping</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            slate: {
              900: '#0f172a',
              800: '#1e293b',
              700: '#334155',
            }
          }
        }
      }
    }
  </script>

  <!-- Manifest -->
  <link rel="manifest" href="/manifest.webmanifest" />
  <meta name="theme-color" content="#0f172a" />
  <link rel="icon" href="/icons/icon-192.png" sizes="192x192" type="image/png" />
  <link rel="apple-touch-icon" href="/icons/icon-192.png" />
</head>
<body class="min-h-screen bg-slate-900 text-white">
  <header class="flex items-center justify-between px-4 py-3 border-b border-slate-800">
    <h1 class="text-xl font-semibold tracking-wide">hafalan retyping</h1>
    <div class="flex items-center gap-2">
      <button id="installBtn" class="hidden px-3 py-1 rounded bg-slate-800 hover:bg-slate-700 smooth text-sm">Install</button>
      <button id="logoutBtn" class="hidden px-3 py-1 rounded bg-slate-800 hover:bg-slate-700 smooth text-sm">Log keluar</button>
    </div>
  </header>

  <main id="app" class="p-4">
    <!-- Page login -->
    <section id="page-login" class="grid place-items-center">
      <div class="max-w-md w-full bg-slate-800/50 rounded-lg p-6">
        <h2 class="text-lg font-semibold tracking-wide mb-2">Masuk akaun</h2>
        <p class="text-slate-300 mb-4">Log masuk dengan Google untuk mula menyimpan subjek, topik, dan fakta anda.</p>
        <button id="loginBtn" class="w-full px-4 py-2 rounded bg-slate-800 hover:bg-slate-700 font-semibold tracking-wide">
          Log masuk dengan Google
        </button>
      </div>
    </section>

    <!-- Page subjects -->
    <section id="page-subjects" class="hidden">
      <div class="mb-4 flex items-center gap-2">
        <input id="subjectSearch" type="text" placeholder="Cari subjek..." class="w-full px-3 py-2 rounded bg-slate-800 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-700" />
        <button id="addSubjectBtn" class="px-3 py-2 rounded bg-slate-800 hover:bg-slate-700 font-semibold">Tambah subjek</button>
      </div>
      <div id="subjectsList" class="grid gap-2"></div>
    </section>

    <!-- Page topics -->
    <section id="page-topics" class="hidden">
      <div class="mb-2 flex items-center justify-between">
        <button id="backToSubjects" class="px-3 py-1 rounded bg-slate-800 hover:bg-slate-700 text-sm">Kembali</button>
        <h3 id="currentSubjectName" class="font-semibold tracking-wide"></h3>
      </div>
      <div class="mb-4 flex items-center gap-2">
        <input id="topicSearch" type="text" placeholder="Cari topik..." class="w-full px-3 py-2 rounded bg-slate-800 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-700" />
        <button id="addTopicBtn" class="px-3 py-2 rounded bg-slate-800 hover:bg-slate-700 font-semibold">Tambah topik</button>
      </div>
      <div id="topicsList" class="grid gap-2"></div>
    </section>

    <!-- Page facts -->
    <section id="page-facts" class="hidden">
      <div class="mb-2 flex items-center justify-between">
        <button id="backToTopics" class="px-3 py-1 rounded bg-slate-800 hover:bg-slate-700 text-sm">Kembali</button>
        <h3 id="currentTopicName" class="font-semibold tracking-wide"></h3>
      </div>
      <div class="mb-4 flex items-center gap-2">
        <input id="factSearch" type="text" placeholder="Cari fakta..." class="w-full px-3 py-2 rounded bg-slate-800 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-700" />
        <button id="addFactBtn" class="px-3 py-2 rounded bg-slate-800 hover:bg-slate-700 font-semibold">Tambah fakta hafalan</button>
      </div>
      <div id="factsList" class="grid gap-2"></div>
    </section>

    <!-- Page practice -->
    <section id="page-practice" class="hidden">
      <div class="mb-2 flex items-center justify-between">
        <button id="backToFacts" class="px-3 py-1 rounded bg-slate-800 hover:bg-slate-700 text-sm">Kembali</button>
        <div class="text-sm text-slate-300">Jumlah ulangan: <span id="practiceCount">0</span></div>
      </div>
      <div class="mb-3">
        <h4 class="font-semibold tracking-wide mb-1">Fakta</h4>
        <div id="practiceFactTitle" class="text-slate-200"></div>
      </div>
      <div class="mb-3">
        <h4 class="font-semibold tracking-wide mb-1">Ayat</h4>
        <div id="practiceFactSentence" class="text-slate-200"></div>
      </div>
      <div class="mb-3">
        <button id="addPracticeRowBtn" class="px-3 py-2 rounded bg-slate-800 hover:bg-slate-700 font-semibold">Tambah ulangan</button>
      </div>
      <div id="practiceRows" class="grid gap-4"></div>
      <div class="mt-4">
        <button id="submitPracticeBtn" class="px-4 py-2 rounded bg-slate-800 hover:bg-slate-700 font-semibold">Done</button>
      </div>
      <p id="practiceFeedback" class="mt-2 text-slate-300"></p>
    </section>
  </main>

  <footer class="px-4 py-6 text-center text-sm text-slate-400">
    Dibina untuk menghafal fakta dengan menulis semula huruf dalam ruang kosong.
  </footer>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import { getFirestore, collection, doc, addDoc, updateDoc, deleteDoc, getDocs, query, orderBy, enableIndexedDbPersistence } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDa3a8CIca9rqjOFnYILwfr2miOFARk6Y8",
      authDomain: "hafalan-retyping.firebaseapp.com",
      projectId: "hafalan-retyping",
      storageBucket: "hafalan-retyping.firebasestorage.app",
      messagingSenderId: "922100880106",
      appId: "1:922100880106:web:c658bf5dafad5315b23d93",
      measurementId: "G-EDL6ZF134G"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();
    const db = getFirestore(app);
    enableIndexedDbPersistence(db).catch(err => console.warn("Persistence error:", err.code));

    // ... (logik SPA sama seperti yang kita bincang: login, subjects, topics, facts, practice)
    // Kau boleh guna kod penuh yang aku bagi sebelum ni, cuma gantikan firebaseConfig dengan yang ini.
  </script>
</body>
</html>
